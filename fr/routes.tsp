import "@azure-tools/typespec-azure-core";
import "@typespec/rest";
import "@typespec/versioning";
import "./models.tsp";

using TypeSpec.Rest;
using TypeSpec.Http;
using TypeSpec.Versioning;

namespace FormRecognizer;

interface DocumentModelsOperations {
  @summary("Analyze document")
  @doc("Analyzes document with document model.")
  @route("/documentModels/{modelId}:analyze")
  @post
  analyzeDocument is Azure.Core.Foundations.LongRunningOperation<
    {
      @doc("Unique document model name.")
      @path
      modelId: string;

      @doc("List of 1-based page numbers to analyze.  Ex. \"1-3,5,7-9\"")
      @query
      pages: string;

      @doc("""
Locale hint for text recognition and document analysis.  Value may contain only
the language code (ex. \"en\", \"fr\") or BCP 47 language tag (ex. \"en-US\").
""")
      @query
      locale: string;

      @doc("Method used to compute string offset and length.")
      @query
      stringIndexType: StringIndexType;

      @added(APIVersion.v2023_02_28_preview)
      @doc("List of optional analysis features.")
      @query({
        format: "csv",
      }) // FIXME
      features: DocumentAnalysisFeature[];

      @added(APIVersion.v2023_02_28_preview)
      @doc("List of additional fields to extract.  Ex. \"NumberOfGuests,StoreNumber\"")
      @query({
        format: "csv",
      }) // FIXME
      queryFields: string[];

      @doc("Analyze request parameters.")
      @body
      analyzeRequest: AnalyzeDocumentRequest;
    },
    AnalyzeResultOperation
  >;

  @summary("Get analyze result")
  @doc("Gets the result of document analysis.")
  @route("/documentModels/{modelId}/analyzeResults/{resultId}")
  @get
  getAnalyzeResult is Azure.Core.Foundations.Operation<
    {
      @doc("Unique document model name.")
      @path
      modelId: string;

      @doc("Analyze operation result ID.")
      @path
      @key
      resultId: string;
    },
    AnalyzeResultOperation
  >;

  @summary("Build document model")
  @doc("Builds a custom document analysis model.")
  @route("/documentModels:build")
  @post
  buildModel is Azure.Core.Foundations.LongRunningOperation<
    {
      @doc("Building request parameters.")
      @body
      buildRequest: BuildDocumentModelRequest;
    },
    DocumentModelDetails
  >;

  @summary("Compose document model")
  @doc("Creates a new document model from document types of existing document models.")
  @route("/documentModels:compose")
  @post
  composeModel is Azure.Core.Foundations.LongRunningOperation<
    {
      @doc("Compose request parameters.")
      @body
      composeRequest: ComposeDocumentModelRequest;
    },
    DocumentModelDetails
  >;

  @summary("Generate copy authorization")
  @doc("""
Generates authorization to copy a document model to this location with
specified modelId and optional description.
""")
  authorizeModelCopy is Azure.Core.ResourceCreateWithServiceProvidedName<CopyAuthorization>;

  @summary("Copy document model")
  @doc("Copies document model to the target resource, region, and modelId.")
  @route("/documentModels/{modelId}:copyTo")
  @post
  copyModelTo is Azure.Core.Foundations.LongRunningOperation<
    {
      @doc("Unique document model name.")
      @path
      modelId: string;

      @doc("Copy to request parameters.")
      @body
      copyToRequest: CopyAuthorization;
    },
    DocumentModelDetails
  >;

  @summary("List document models")
  @doc("List all document models")
  listModels is Azure.Core.ResourceList<DocumentModelSummary>;

  @summary("Get document model")
  @doc("Gets detailed document model information.")
  getModel is Azure.Core.ResourceRead<DocumentModelDetails>;

  @summary("Delete document model")
  @doc("Deletes document model.")
  deleteModel is Azure.Core.ResourceDelete<DocumentModelDetails>;
}

interface MiscellaneousOperations {
  @summary("List operations")
  @doc("Lists all operations.")
  listOperations is Azure.Core.ResourceList<OperationSummary>;

  @summary("Get operation")
  @doc("Gets operation info.")
  getOperation is Azure.Core.ResourceRead<OperationDetails>;

  @summary("Get resource info")
  @doc("Return information about the current resource.")
  @route("/info")
  @get
  getResourceInfo is Azure.Core.Foundations.Operation<{}, ResourceDetails>;
}

@added(APIVersion.v2023_02_28_preview)
interface DocumentClassifiersOperations {
  @added(APIVersion.v2023_02_28_preview)
  @summary("Build document classifier")
  @doc("Builds a custom document classifier.")
  @route("/documentClassifiers:build")
  @post
  buildClassifier is Azure.Core.Foundations.LongRunningOperation<
    {
      @doc("Building request parameters.")
      @body
      buildRequest: BuildDocumentClassifierRequest;
    },
    DocumentClassifierDetails
  >;

  @added(APIVersion.v2023_02_28_preview)
  @summary("List document classifiers")
  @doc("List all document classifiers.")
  listClassifiers is Azure.Core.ResourceList<DocumentClassifierDetails>;

  @added(APIVersion.v2023_02_28_preview)
  @summary("Get document classifier")
  @doc("Gets detailed document classifier information.")
  getClassifier is Azure.Core.ResourceRead<DocumentClassifierDetails>;

  @added(APIVersion.v2023_02_28_preview)
  @summary("Delete document classifier")
  @doc("Deletes document classifier.")
  deleteClassifier is Azure.Core.ResourceDelete<DocumentClassifierDetails>;

  @added(APIVersion.v2023_02_28_preview)
  @summary("Classify document")
  @doc("Classifies document with document classifier.")
  @route("/documentClassifiers/{classifierId}:analyze")
  @post
  classifyDocument is Azure.Core.Foundations.Operation<
    {
      @doc("Unique document classifier name.")
      @path
      classifierId: string;

      @doc("Method used to compute string offset and length.")
      @query
      stringIndexType: StringIndexType;

      @doc("Classify request parameters.")
      @body
      classifyRequest: ClassifyDocumentRequest;
    },
    AnalyzeResultOperation
  >;

  @added(APIVersion.v2023_02_28_preview)
  @summary("Get document classifier result")
  @doc("Gets the result of document classifier.")
  @route("/documentClassifiers/{classifierId}/analyzeResults/{resultId}")
  @get
  getClassifyResult is Azure.Core.Foundations.Operation<
    {
      @doc("Unique document classifier name.")
      @path
      classifierId: string;

      @doc("Analyze operation result ID.")
      @path
      resultId: string;
    },
    AnalyzeResultOperation
  >;
}
